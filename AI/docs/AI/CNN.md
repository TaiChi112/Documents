# ðŸ§  Convolutional Neural Network (CNN)
> à¹à¸›à¸¥à¹à¸¥à¸°à¸‚à¸¢à¸²à¸¢à¸ˆà¸²à¸à¸ªà¹„à¸¥à¸”à¹Œ â€œAI-CNN Machine Vision â€” COS3109â€

---

## ðŸŽ¯ à¸«à¸±à¸§à¸‚à¹‰à¸­ (Agenda)
- Convolutional Neural Network (CNN)  
- Top Applications of Machine Vision  
- à¹à¸™à¸§à¸„à¸´à¸”à¸žà¸·à¹‰à¸™à¸à¸²à¸™à¸‚à¸­à¸‡ CNN  
- à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡à¸‡à¹ˆà¸²à¸¢ (Simple Example)  
- Workshop: TensorFlow (Keras) à¸šà¸™ Google Colab  

---

## ðŸš€ à¸à¸²à¸£à¸›à¸£à¸°à¸¢à¸¸à¸à¸•à¹Œà¹ƒà¸Šà¹‰ Machine Vision (Top 7 Applications)

| à¸«à¸¡à¸§à¸” | à¸£à¸²à¸¢à¸¥à¸°à¹€à¸­à¸µà¸¢à¸” | à¹à¸«à¸¥à¹ˆà¸‡à¸­à¹‰à¸²à¸‡à¸­à¸´à¸‡ |
|:--|:--|:--|
| **Guidance** | à¹ƒà¸Šà¹‰à¸£à¸°à¸šà¸¸à¸•à¸³à¹à¸«à¸™à¹ˆà¸‡à¹à¸¥à¸°à¸à¸²à¸£à¸§à¸²à¸‡à¸Šà¸´à¹‰à¸™à¸ªà¹ˆà¸§à¸™à¸­à¸¢à¹ˆà¸²à¸‡à¸–à¸¹à¸à¸•à¹‰à¸­à¸‡ (Positioning, Locating, Ensuring placement) | [robots.net](https://robots.net/tech-reviews/deep-learning-applications/) |
| **Identification** | à¸à¸²à¸£à¸­à¹ˆà¸²à¸™à¸šà¸²à¸£à¹Œà¹‚à¸„à¹‰à¸”, à¸à¸²à¸£à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸šà¸£à¸£à¸ˆà¸¸à¸ à¸±à¸“à¸‘à¹Œ (Barcode, Matrix code, Packaging QC) | [robots.net](https://robots.net/tech-reviews/deep-learning-applications/) |
| **Gauging** | à¸•à¸£à¸§à¸ˆà¸ˆà¸±à¸šà¸‚à¹‰à¸­à¸œà¸´à¸”à¸žà¸¥à¸²à¸”à¹ƒà¸™à¸à¸²à¸£à¸œà¸¥à¸´à¸• (Production errors) | [robots.net](https://robots.net/tech-reviews/deep-learning-applications/) |
| **Inspection** | à¸•à¸£à¸§à¸ˆà¸ˆà¸±à¸šà¸•à¸³à¸«à¸™à¸´à¸«à¸£à¸·à¸­à¸‚à¹‰à¸­à¸šà¸à¸žà¸£à¹ˆà¸­à¸‡à¸‚à¸­à¸‡à¸ªà¸´à¸™à¸„à¹‰à¸² (Flaw Detection) â€” à¸¡à¸µà¸„à¸§à¸²à¸¡à¹à¸¡à¹ˆà¸™à¸¢à¸³à¸ªà¸¹à¸‡à¸à¸§à¹ˆà¸²à¸¡à¸™à¸¸à¸©à¸¢à¹Œ | [robots.net](https://robots.net/tech-reviews/deep-learning-applications/) |
| **Object Detection** | à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸§à¹ˆà¸²à¸§à¸±à¸•à¸–à¸¸à¸›à¸£à¸²à¸à¸à¸«à¸£à¸·à¸­à¹„à¸¡à¹ˆà¸›à¸£à¸²à¸à¸à¹ƒà¸™à¸ à¸²à¸ž | [robots.net](https://robots.net/tech-reviews/deep-learning-applications/) |
| **Print Defect Detection** | à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸„à¸¸à¸“à¸ à¸²à¸žà¸à¸²à¸£à¸žà¸´à¸¡à¸žà¹Œ à¸‰à¸¥à¸²à¸ à¹à¸¥à¸°à¸šà¸£à¸£à¸ˆà¸¸à¸ à¸±à¸“à¸‘à¹Œ | [robots.net](https://robots.net/tech-reviews/deep-learning-applications/) |
| **Classification** | à¸—à¸³à¸™à¸²à¸¢à¸§à¹ˆà¸²à¸§à¸±à¸•à¸–à¸¸à¸­à¸¢à¸¹à¹ˆà¹ƒà¸™à¸›à¸£à¸°à¹€à¸ à¸—à¹ƒà¸” (à¹€à¸Šà¹ˆà¸™ à¹à¸¡à¸§/à¸«à¸¡à¸²/à¸£à¸–à¸¢à¸™à¸•à¹Œ) | [robots.net](https://robots.net/tech-reviews/deep-learning-applications/) |

---

## ðŸ” à¸à¸²à¸£à¸—à¸³à¸‡à¸²à¸™à¸‚à¸­à¸‡ Filters à¹ƒà¸™ Image Processing

**Filter (à¸«à¸£à¸·à¸­ Kernel):**  
à¸„à¸·à¸­à¹€à¸¡à¸—à¸£à¸´à¸à¸‹à¹Œà¸‚à¸™à¸²à¸” \( n \times n \) à¸—à¸µà¹ˆà¹ƒà¸Šà¹‰à¸„à¸³à¸™à¸§à¸“à¸„à¹ˆà¸²à¸žà¸´à¸à¹€à¸‹à¸¥à¹ƒà¸«à¸¡à¹ˆ à¹‚à¸”à¸¢à¸žà¸´à¸ˆà¸²à¸£à¸“à¸²à¸žà¸´à¸à¹€à¸‹à¸¥à¸£à¸­à¸šà¸‚à¹‰à¸²à¸‡

### à¸›à¸£à¸°à¹€à¸ à¸—à¸‚à¸­à¸‡ Filters
| à¸›à¸£à¸°à¹€à¸ à¸— | à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡ | à¸à¸²à¸£à¸—à¸³à¸‡à¸²à¸™ |
|:--|:--|:--|
| **Linear Filters** | Box, Gaussian, Laplace | à¹ƒà¸Šà¹‰à¸à¸²à¸£ Convolution à¹€à¸žà¸·à¹ˆà¸­à¸¥à¸” noise à¸«à¸£à¸·à¸­à¸›à¸£à¸±à¸šà¸„à¸§à¸²à¸¡à¸Šà¸±à¸” |
| **Non-linear Filters** | Min, Max, Median | à¹ƒà¸Šà¹‰à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™à¹„à¸¡à¹ˆà¹€à¸Šà¸´à¸‡à¹€à¸ªà¹‰à¸™ à¹€à¸Šà¹ˆà¸™ à¸„à¹ˆà¸²à¸à¸¥à¸²à¸‡ (median) à¹€à¸žà¸·à¹ˆà¸­à¸à¸³à¸ˆà¸±à¸” noise |

**à¸ªà¸¡à¸à¸²à¸£ Convolution (à¸žà¸·à¹‰à¸™à¸à¸²à¸™):**
\[
S(i,j) = (K * I)(i,j) = \sum_m \sum_n I(i+m, j+n) \, K(m,n)
\]

> à¹‚à¸”à¸¢ \(I\) = à¸ à¸²à¸žà¸•à¹‰à¸™à¸‰à¸šà¸±à¸š, \(K\) = kernel, \(S\) = à¸ à¸²à¸žà¸œà¸¥à¸¥à¸±à¸žà¸˜à¹Œ

---

## âš ï¸ à¸‚à¹‰à¸­à¸ˆà¸³à¸à¸±à¸”à¸‚à¸­à¸‡ ANN à¹€à¸¡à¸·à¹ˆà¸­à¹ƒà¸Šà¹‰à¸à¸±à¸šà¸ à¸²à¸ž

1. à¸•à¹‰à¸­à¸‡à¹ƒà¸Šà¹‰à¸à¸²à¸£à¸„à¸³à¸™à¸§à¸“à¸¡à¸²à¸à¹€à¸à¸´à¸™à¹„à¸›  
2. à¸¡à¸­à¸‡à¸—à¸¸à¸à¸žà¸´à¸à¹€à¸‹à¸¥à¹€à¸«à¸¡à¸·à¸­à¸™à¸à¸±à¸™ (à¹„à¸¡à¹ˆà¸£à¸¹à¹‰à¸•à¸³à¹à¸«à¸™à¹ˆà¸‡à¸‚à¸­à¸‡à¸§à¸±à¸•à¸–à¸¸)  
3. à¹„à¸¡à¹ˆà¸ªà¸²à¸¡à¸²à¸£à¸–à¸£à¸±à¸šà¸£à¸¹à¹‰à¸¥à¸±à¸à¸©à¸“à¸°à¹€à¸‰à¸žà¸²à¸°à¹ƒà¸™à¸žà¸·à¹‰à¸™à¸—à¸µà¹ˆà¹€à¸¥à¹‡à¸ à¹† à¹„à¸”à¹‰à¸”à¸µ  

ðŸ‘‰ à¸ˆà¸¶à¸‡à¸•à¹‰à¸­à¸‡à¹ƒà¸Šà¹‰ **Convolutional Neural Network (CNN)** à¹à¸—à¸™ ANN

---

## ðŸ‘ï¸ à¸—à¸³à¹„à¸¡ CNN à¸–à¸¶à¸‡à¹€à¸‚à¹‰à¸²à¹ƒà¸ˆà¸ à¸²à¸žà¹„à¸”à¹‰à¸”à¸µà¸à¸§à¹ˆà¸²?

à¸¡à¸™à¸¸à¸©à¸¢à¹Œà¸£à¸¹à¹‰à¸ˆà¸³à¸ à¸²à¸žà¹„à¸”à¹‰à¸‡à¹ˆà¸²à¸¢à¹€à¸žà¸£à¸²à¸° â€œà¸ªà¸¡à¸­à¸‡à¸¡à¸µà¸à¸²à¸£à¹€à¸Šà¸·à¹ˆà¸­à¸¡à¹‚à¸¢à¸‡à¹à¸šà¸šà¸¥à¸³à¸”à¸±à¸šà¸Šà¸±à¹‰à¸™â€  
CNN à¸ˆà¸³à¸¥à¸­à¸‡à¹à¸™à¸§à¸„à¸´à¸”à¸™à¸µà¹‰ à¹‚à¸”à¸¢à¹€à¸£à¸µà¸¢à¸™à¸£à¸¹à¹‰à¸ˆà¸²à¸ â€œà¸ªà¹ˆà¸§à¸™à¹€à¸¥à¹‡à¸ à¹† à¸‚à¸­à¸‡à¸ à¸²à¸žâ€ (local features)  
â†’ à¹à¸¥à¹‰à¸§à¸„à¹ˆà¸­à¸¢ à¹† à¸£à¸§à¸¡à¹€à¸›à¹‡à¸™à¸ à¸²à¸žà¸£à¸§à¸¡ (global features)

**à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡:**  
- à¸Šà¸±à¹‰à¸™à¹à¸£à¸à¹€à¸£à¸µà¸¢à¸™à¸£à¸¹à¹‰ â€œà¹€à¸ªà¹‰à¸™à¸‚à¸­à¸šâ€  
- à¸Šà¸±à¹‰à¸™à¸•à¹ˆà¸­à¸¡à¸²à¹€à¸£à¸µà¸¢à¸™à¸£à¸¹à¹‰ â€œà¸£à¸¹à¸›à¸—à¸£à¸‡â€  
- à¸Šà¸±à¹‰à¸™à¸¥à¸¶à¸ à¹† à¹€à¸£à¸µà¸¢à¸™à¸£à¸¹à¹‰ â€œà¸§à¸±à¸•à¸–à¸¸à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”â€  

---

## ðŸ§¬ à¹‚à¸„à¸£à¸‡à¸ªà¸£à¹‰à¸²à¸‡à¸‚à¸­à¸‡ CNN

CNN à¹€à¸›à¹‡à¸™ **à¹‚à¸¡à¹€à¸”à¸¥ Deep Learning** à¸—à¸µà¹ˆà¸­à¸­à¸à¹à¸šà¸šà¸¡à¸²à¹€à¸žà¸·à¹ˆà¸­ â€œà¹€à¸‚à¹‰à¸²à¹ƒà¸ˆà¸ à¸²à¸žâ€  
à¸œà¸¹à¹‰à¸šà¸¸à¸à¹€à¸šà¸´à¸à¹à¸™à¸§à¸„à¸´à¸”à¸„à¸·à¸­ **Yann LeCun** (Facebook, MNIST project)

---

### ðŸ§© à¸ªà¹ˆà¸§à¸™à¸›à¸£à¸°à¸à¸­à¸šà¸‚à¸­à¸‡ CNN

1. **Input Layer**  
   - à¸£à¸±à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ à¸²à¸žà¸‚à¸™à¸²à¸” \( n \times m \times 3 \) (RGB)  
   - à¹€à¸Šà¹ˆà¸™ 32Ã—32Ã—3 à¸ªà¸³à¸«à¸£à¸±à¸šà¸ à¸²à¸žà¸ªà¸µ  

2. **Convolution Layer**  
   - à¹ƒà¸Šà¹‰ kernel à¹€à¸žà¸·à¹ˆà¸­à¸ªà¸à¸±à¸” feature  
   - à¸ˆà¸³à¸™à¸§à¸™ filter à¸¡à¸²à¸ â†’ à¸•à¸£à¸§à¸ˆà¸ˆà¸±à¸š edge/shape à¹„à¸”à¹‰à¸¡à¸²à¸  
   - à¸œà¸¥à¸¥à¸±à¸žà¸˜à¹Œà¹€à¸£à¸µà¸¢à¸à¸§à¹ˆà¸² **Feature Map**

3. **Non-linearity Layer (Activation)**  
   - à¹ƒà¸Šà¹‰à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™à¹€à¸Šà¹ˆà¸™ **ReLU, Sigmoid, Tanh**  
   - à¸Šà¹ˆà¸§à¸¢à¹€à¸žà¸´à¹ˆà¸¡à¸„à¸§à¸²à¸¡à¹„à¸¡à¹ˆà¹€à¸Šà¸´à¸‡à¹€à¸ªà¹‰à¸™à¹ƒà¸«à¹‰à¸à¸±à¸šà¹‚à¸¡à¹€à¸”à¸¥  

4. **Pooling Layer**  
   - à¸¥à¸”à¸‚à¸™à¸²à¸”à¸ à¸²à¸ž (à¹€à¸Šà¹ˆà¸™ Max/Average Pooling)  
   - à¸£à¸±à¸à¸©à¸²à¸„à¸¸à¸“à¸¥à¸±à¸à¸©à¸“à¸°à¸ªà¸³à¸„à¸±à¸à¹à¸¥à¸°à¸¥à¸”à¸à¸²à¸£à¸„à¸³à¸™à¸§à¸“  

5. **Fully Connected Layer**  
   - à¹à¸›à¸¥à¸‡ Feature Map à¹ƒà¸«à¹‰à¹€à¸›à¹‡à¸™à¹€à¸§à¸à¹€à¸•à¸­à¸£à¹Œ  
   - à¹ƒà¸Šà¹‰à¸ªà¸³à¸«à¸£à¸±à¸šà¸à¸²à¸£à¸—à¸³à¸™à¸²à¸¢ (classification)  

6. **Normalization / Output Layer**  
   - à¹ƒà¸Šà¹‰ **Softmax function** à¹€à¸žà¸·à¹ˆà¸­à¹à¸›à¸¥à¸‡à¸„à¹ˆà¸²à¹ƒà¸«à¹‰à¸­à¸¢à¸¹à¹ˆà¹ƒà¸™à¸Šà¹ˆà¸§à¸‡ [0,1]  
   - à¹à¸ªà¸”à¸‡à¸„à¸§à¸²à¸¡à¸™à¹ˆà¸²à¸ˆà¸°à¹€à¸›à¹‡à¸™à¸‚à¸­à¸‡à¹à¸•à¹ˆà¸¥à¸°à¸„à¸¥à¸²à¸ª  

---

### âš™ï¸ à¸à¸²à¸£à¹€à¸£à¸µà¸¢à¸™à¸£à¸¹à¹‰à¸‚à¸­à¸‡ CNN (Backpropagation)

1. **Forward Pass:**  
   à¸„à¸³à¸™à¸§à¸“à¸„à¹ˆà¸²à¸ˆà¸²à¸ input â†’ convolution â†’ pooling â†’ fully connected â†’ output  

2. **Loss Calculation:**  
   à¸„à¸³à¸™à¸§à¸“à¸‚à¹‰à¸­à¸œà¸´à¸”à¸žà¸¥à¸²à¸”à¸£à¸°à¸«à¸§à¹ˆà¸²à¸‡à¸œà¸¥à¸¥à¸±à¸žà¸˜à¹Œà¸à¸±à¸šà¸„à¹ˆà¸²à¸ˆà¸£à¸´à¸‡  

3. **Backward Pass (Backpropagation):**  
   à¸„à¸³à¸™à¸§à¸“ gradient à¸‚à¸­à¸‡à¸žà¸²à¸£à¸²à¸¡à¸´à¹€à¸•à¸­à¸£à¹Œà¹à¸•à¹ˆà¸¥à¸° layer  
   à¹‚à¸”à¸¢à¹ƒà¸Šà¹‰ **Chain Rule**

4. **Parameter Update:**  
   à¸›à¸£à¸±à¸šà¸™à¹‰à¸³à¸«à¸™à¸±à¸ (w, b) à¸”à¹‰à¸§à¸¢à¸­à¸±à¸¥à¸à¸­à¸£à¸´à¸—à¸¶à¸¡ Optimization à¹€à¸Šà¹ˆà¸™ **SGD / Adam**

---

## ðŸ§  Mermaid Diagram â€” à¸ªà¸–à¸²à¸›à¸±à¸•à¸¢à¸à¸£à¸£à¸¡à¸‚à¸­à¸‡ CNN

```mermaid
graph TD
  A[Input Image] --> B[Convolution Layer]
  B --> C[ReLU Activation]
  C --> D[Pooling Layer]
  D --> E[Flatten]
  E --> F[Fully Connected Layer]
  F --> G[Softmax Output]
